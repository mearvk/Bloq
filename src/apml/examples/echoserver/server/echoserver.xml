<?xml version="1.0" encoding="UTF-8"?>
<?apml version="1.0" encoding="UTF-8"?>

<package name="globals" default="examples.echoserver" sourcedir="/source" builddir="/build">
    
    <apml language="Java 9" version="1.0" class="Apmlsystem" infer="true">  

        <implements class="apml.interfaces.Apmlsystemelement"/>        

        <package name="servers" default="examples.echoserver.servers" sourcedir="/source" builddir="/build">
            
            <system id="echoserver" start="true" bodi="//systems/echoserver/{this.id}" class="Echoserversystem">                  
                <implements class="apml.interfaces.Apmlsystemelement"/>
                <object id="echoserver" start="true" bodi="//echoserver/objects/echoserver" class="Echoserver">                                                                                  
                    <implements class="apml.interfaces.Apmlsystemelement"/>
                    
                    <listener id="esocl" bodi="//systems/echoserver/listeners/onconnect/{this.id}" class="EchoserverOnconnectListener" with="*">
                        <subscriber class="ESOnconnectSubscriber_001"></subscriber>
                        <subscriber class="ESOnconnectSubscriber_002"></subscriber>
                        <subscriber class="ESOnconnectSubscriber_003"></subscriber>
                    </listener>
                    
                    <listener id="esoel" bodi="//systems/echoserver/listeners/onexit/{this.id}" class="EchoserverOnexitListener" with="*">
                        <subscriber class="ESOnexitSubscriber_001"></subscriber>
                        <subscriber class="ESOnexitSubscriber_002"></subscriber>
                        <subscriber class="ESOnexitSubscriber_003"></subscriber>
                    </listener>
                    
                    <listener id="esorl" bodi="//systems/echoserver/listeners/onread/{this.id}" class="EchoserverOnreadListener" with="*">
                        <subscriber class="ESOnreceiptSubscriber_001"></subscriber>
                        <subscriber class="ESOnreceiptSubscriber_002"></subscriber>
                        <subscriber class="ESOnreceiptSubscriber_003"></subscriber>
                    </listener>
                    
                    <listener id="esodl" bodi="//systems/echoserver/listeners/ondispatch/{this.id}" class="EchoserverOndispatchListener" with="*">
                        <subscriber class="ESOndispatchSubscriber_001"></subscriber>
                        <subscriber class="ESOndispatchSubscriber_002"></subscriber>
                        <subscriber class="ESOndispatchSubscriber_003"></subscriber>
                    </listener>                      
                </object>                  
            </system>   
            
        </package>
                
        <package name="clients" default="examples.echoserver.clients" sourcedir="/source" builddir="/build">
            <system id="echoclient" start="true" bodi="//echoclient/systems/{this.id}" class="Echoclientsystem">        
                <object start="true" bodi="//echoclient/objects/{this.id}" class="Echoclient">
                    <listener class="Clientsocketondispatchlistener">
                        <subscriber class="Onclientdispatch_1"></subscriber>
                        <subscriber class="Onclientdispatch_2"></subscriber>
                        <subscriber class="Onclientdispatch_3"></subscriber>
                    </listener>
                    <listener class="Clientsocketonreceiptlistener">
                        <subscriber class="Onclientdispatch_1"></subscriber>
                        <subscriber class="Onclientdispatch_2"></subscriber>
                        <subscriber class="Onclientdispatch_3"></subscriber>
                    </listener>                
                </object>        
            </system>                      
        </package>

        <driver class="StandardDriver"> //to start and attach APML objects to system framework; to build out skeleton for starters
            <template></template>
            <template></template>
            <template></template>
            <template></template>
        </driver>

        <compiler class="StdApmlToJavaCompiler"> //move APML markup over to Java
            <architect>Max Rupplin</architect>        
            <template type="camelcase"></template>
            <template type="annotations">formal</template>
            <template type="brackets">newline</template>
            <template type="class_treatment">inner</template>
        </compiler>

        <compiler class="StdJavaToApmlCompiler"> //move Java source code over to APML markup
            <architect>Max Rupplin</architect>        
            <template type=""></template>
            <template type=""></template>
        </compiler>    

        <dynamiclistener class="StdDynamicListener" bodi="//dynamiclisteners/1">
            <object start="true"></object>
        </dynamiclistener>

    </apml>
</package>