<?xml version="1.0" encoding="UTF-8"?>
<?apml version="1.0" encoding="UTF-8"?>

<package name="globals" default="examples.echoserver" sourcedir="/source" builddir="/build">
    <apml language="Java 9" version="1.0" class="Apmlsystem" infer="true">  

        <definitions>
            <echoserver extends="ServerSocketImpl" class="Echoserver"></echoserver>   
        </definitions>                                   

        <package name="servers" default="examples.echoserver.servers" sourcedir="/source" builddir="/build">
            <system id="echoserver" start="true" bodi="//echoserver/systems/{this.id}" class="Echoserversystem">                  
                
                <object id="echoserver" start="true" bodi="//echoserver/objects/1" class="Echoserver">                       
                    <listener id="esocl" bodi="//echoserver/listeners/onconnect/{this.id}" class="Onconnectlistener" with="*">
                        <subscriber class="Onconnectsubscriber_001"></subscriber>
                        <subscriber class="Onconnectsubscriber_002"></subscriber>
                        <subscriber class="Onconnectsubscriber_003"></subscriber>
                    </listener>
                    <listener id="esoel" bodi="//echoserver/listeners/onexit/{this.id}" class="Onexitlistener" with="*">
                        <subscriber class="Onexitsubscriber_001"></subscriber>
                        <subscriber class="Onexitsubscriber_002"></subscriber>
                        <subscriber class="Onexitsubscriber_003"></subscriber>
                    </listener>
                    <listener id="esorl" bodi="//echoserver/listeners/onread/{this.id}" class="Onreadlistener" with="*">
                        <subscriber class="Onreceiptsubscriber_001"></subscriber>
                        <subscriber class="Onreceiptsubscriber_002"></subscriber>
                        <subscriber class="Onreceiptsubscriber_003"></subscriber>
                    </listener>
                    <listener id="esodl" bodi="//echoserver/listeners/ondispatch/{this.id}" class="Ondispatchlistener" with="*">
                        <subscriber class="Ondispatchsubscriber_001"></subscriber>
                        <subscriber class="Ondispatchsubscriber_002"></subscriber>
                        <subscriber class="Ondispatchsubscriber_003"></subscriber>
                    </listener>  
                </object>   

            </system>   
        </package>

        <package name="clients" default="examples.echoserver.clients" sourcedir="/source" builddir="/build">
            <system id="echoclient" start="true" bodi="//echoclient/systems/{this.id}" class="Echoclientsystem">        
                <object start="true" bodi="//echoclient/objects/{this.id}" class="Echoclient">
                    <listener class="Clientsocketondispatchlistener">
                        <subscriber class="Onclientdispatch_1"></subscriber>
                        <subscriber class="Onclientdispatch_2"></subscriber>
                        <subscriber class="Onclientdispatch_3"></subscriber>
                    </listener>
                    <listener class="Clientsocketonreceiptlistener">
                        <subscriber class="Onclientdispatch_1"></subscriber>
                        <subscriber class="Onclientdispatch_2"></subscriber>
                        <subscriber class="Onclientdispatch_3"></subscriber>
                    </listener>                
                </object>        
            </system>                      
        </package>

        <driver class="StandardDriver"> //to start and attach APML objects to system framework; to build out skeleton for starters
            <template></template>
            <template></template>
            <template></template>
            <template></template>
        </driver>

        <compiler class="StdApmlToJavaCompiler"> //move APML markup over to Java
            <architect>Max Rupplin</architect>        
            <template type="camelcase"></template>
            <template type="annotations">formal</template>
            <template type="brackets">newline</template>
            <template type="class_treatment">inner</template>
        </compiler>

        <compiler class="StdJavaToApmlCompiler"> //move Java source code over to APML markup
            <architect>Max Rupplin</architect>        
            <template type=""></template>
            <template type=""></template>
        </compiler>    

        <dynamiclistener class="StdDynamicListener">
            <object start="true"></object>
        </dynamiclistener>

    </apml>
</package>